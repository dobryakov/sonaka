# Implementation Plan: Интеграция дизайна Figma

**Branch**: `001-figma-design` | **Date**: 2025-01-27 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/001-figma-design/spec.md`

**Note**: This plan is generated by the `/speckit.plan` command.

## Summary

Интеграция дизайн-системы из каталога Figma во frontend приложение личного кабинета Sonaka. Применение единообразного визуального стиля с использованием glass-morphism эффектов, мягких бирюзовых/голубых оттенков (#06b6d4, #22d3ee, #0ea5e9), градиентных заголовков, плавных анимаций и бокового меню навигации. Используется существующий стек: React 18.3.1, TypeScript, Vite, без изменения функциональности и API интеграции.

## Technical Context

**Language/Version**: TypeScript 5.4.0, Node.js 18+ (React 18.3.1)  
**Primary Dependencies**: 
- React 18.3.1, React DOM 18.3.1
- React Router DOM 6.28.0 (навигация)
- i18next 23.10.1, react-i18next 15.0.1 (локализация)
- Vite 5.0.0 (сборка)
- CSS Modules + CSS переменные (custom properties) для стилизации
- CSS animations/transitions (нативные, без дополнительных библиотек)  
**Storage**: N/A (frontend-only feature, данные из существующего REST API)  
**Testing**: 
- Jest 29.7.0, React Testing Library 16.0.0 (unit/component tests)
- Playwright 1.47.0 (E2E tests, отдельный Docker-сервис)
- Компонентные тесты для проверки CSS классов и атрибутов
- E2E тесты для функциональности и базовой визуализации
- Визуальная проверка соответствия дизайну Figma (ручная)  
**Target Platform**: Веб-браузеры (desktop + mobile responsive), минимальная ширина 320px  
**Project Type**: Web (frontend-only изменения)  
**Performance Goals**: 
- Плавные анимации без задержек (переходы ≤ 0.5 сек, без рывков)
- Поддержка prefers-reduced-motion для доступности
- Glass-morphism эффекты не должны деградировать производительность на слабых устройствах  
**Constraints**: 
- Интерфейс на русском языке (i18next уже настроен)
- Современные браузеры с поддержкой CSS backdrop-filter
- Существующая функциональность и API интеграция остаются без изменений
- Адаптивный дизайн для мобильных устройств (min 320px)  
**Scale/Scope**: 
- Все экраны личного кабинета (главная страница, список заказов, детали заказа)
- Компоненты: Sidebar, карточки заказов, карточки статистики, список товаров
- Анимации и эффекты: glass-morphism, градиенты, hover-эффекты, floating фон

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### ✅ Контейнер‑первая архитектура (Docker‑Compose)
- **Compliance**: ✅ PASS
- **Status**: Docker-compose.yml существует, frontend сервис настроен на порту 10002 (> 10000), конфигурация через .env
- **Action Required**: None (frontend-only изменения, не требуют изменений в docker-compose)

### ✅ Автоматизированное тестирование как обязательство
- **Compliance**: ⚠️ CONDITIONAL PASS
- **Status**: Jest, React Testing Library и Playwright настроены. Требуется добавить тесты для новых компонентов и визуальных эффектов
- **Action Required**: 
  - Unit-тесты для новых компонентов (Sidebar, стилизованные карточки)
  - Компонентные тесты для glass-morphism эффектов и анимаций
  - E2E тесты для проверки визуального соответствия дизайну
  - Визуальное регрессионное тестирование (если возможно)

### ✅ Язык интерфейса — русский
- **Compliance**: ✅ PASS
- **Status**: i18next настроен, все строки должны быть в ресурсах локализации
- **Action Required**: 
  - Убедиться, что все новые UI-строки добавлены в локализационные файлы
  - Проверить отсутствие хардкода строк в компонентах

### ✅ Бэкенд: Ruby on Rails + PostgreSQL
- **Compliance**: ✅ PASS
- **Status**: Не затрагивается (frontend-only feature)
- **Action Required**: None

### ✅ Фронтенд: React с фирменным UI
- **Compliance**: ✅ PASS
- **Status**: React используется, требуется применить дизайн из Figma (glass-morphism, бирюзовые/голубые цвета, анимации)
- **Action Required**: 
  - Интеграция дизайн-системы из каталога Figma
  - Применение фирменного стиля ко всем компонентам
  - Обеспечение доступности (prefers-reduced-motion)

### ✅ Тестирование
- **Compliance**: ⚠️ CONDITIONAL PASS
- **Status**: Инфраструктура тестирования есть, требуется добавить тесты для новых компонентов
- **Action Required**: Добавить тесты в рамках реализации компонентов

**Overall Gate Status**: ✅ PASS (с условиями для тестирования)

### Post-Phase 1 Re-evaluation

После Phase 1 (Design & Contracts) все принципы конституции остаются соблюденными:

- ✅ **Контейнер‑первая архитектура**: Не изменена (frontend-only фича)
- ✅ **Автоматизированное тестирование**: План тестирования создан в data-model.md и quickstart.md
- ✅ **Язык интерфейса — русский**: Все новые строки будут добавлены в локализацию
- ✅ **Бэкенд**: Не затрагивается
- ✅ **Фронтенд: React с фирменным UI**: Дизайн-система интегрируется согласно плану
- ✅ **Тестирование**: План тестирования создан, структура тестов определена

**Post-Phase 1 Gate Status**: ✅ PASS

## Project Structure

### Documentation (this feature)

```text
specs/001-figma-design/
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (/speckit.plan command)
├── data-model.md        # Phase 1 output (/speckit.plan command)
├── quickstart.md        # Phase 1 output (/speckit.plan command)
├── contracts/           # Phase 1 output (/speckit.plan command)
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

```text
frontend/
├── src/
│   ├── components/
│   │   ├── common/          # Общие компоненты (LoadingSpinner, etc.)
│   │   ├── Dashboard/       # Компоненты дашборда
│   │   ├── OrderDetails/    # Компоненты деталей заказа
│   │   ├── Sidebar/         # НОВЫЙ: Боковое меню навигации
│   │   ├── Card/            # НОВЫЙ: Базовые карточки с glass-morphism
│   │   └── GradientTitle/   # НОВЫЙ: Градиентные заголовки
│   ├── pages/
│   │   └── DashboardPage.tsx
│   ├── services/            # API сервисы (без изменений)
│   ├── types/               # TypeScript типы (без изменений)
│   ├── hooks/               # React hooks
│   ├── styles/              # НОВЫЙ: Глобальные стили, темы, CSS переменные
│   │   ├── theme.ts         # Цветовая палитра, градиенты
│   │   ├── animations.css   # Keyframes для анимаций
│   │   └── glass-morphism.css # Базовые стили glass-morphism
│   ├── locales/             # Локализация (расширение для новых строк)
│   ├── i18n.ts              # Конфигурация i18next
│   └── main.tsx             # Точка входа (возможны изменения для глобальных стилей)
├── tests/
│   ├── components/          # Компонентные тесты
│   │   ├── Sidebar.test.tsx
│   │   ├── Card.test.tsx
│   │   └── GradientTitle.test.tsx
│   ├── visual/              # НОВЫЙ: Визуальные тесты (если используется)
│   └── e2e/                 # E2E тесты Playwright
│       └── dashboard.spec.ts
└── package.json

backend/                      # Без изменений
├── app/
├── db/
└── spec/

docker-compose.yml            # Без изменений (frontend-only)
.env                          # Без изменений
```

**Structure Decision**: Web application (frontend + backend). Изменения только во frontend. Добавляются новые компоненты (Sidebar, Card, GradientTitle) и директория styles/ для глобальных стилей, темы и CSS переменных. Существующая структура компонентов расширяется, но не перестраивается.

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

*Нет нарушений конституции, требующих обоснования.*
